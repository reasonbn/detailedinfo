<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pohang Makers Map - Auto Reset Mode</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        html, body { height: 100%; margin: 0; padding: 0; font-family: 'Noto Sans KR', sans-serif; color: #333; overflow: hidden; }
        body { display: flex; flex-direction: row; }
        #map { flex: 2; height: 100%; background-color: #f8f9fa; z-index: 1; }
        #sidebar { flex: 1; min-width: 400px; height: 100%; background: #fff; position: relative; box-shadow: -2px 0 10px rgba(0,0,0,0.1); z-index: 2; }

        /* ê°€ì´ë“œ ì•ˆë‚´ë¬¸ ìŠ¤íƒ€ì¼ */
        .guide-banner {
            background: #fff9c4;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 5px solid #fbc02d;
            font-size: 14px;
            line-height: 1.5;
            color: #555;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .map-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 13px;
            z-index: 1000;
            pointer-events: none;
            display: block;
        }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            #map { flex: none; height: 55%; width: 100%; }
            #sidebar { flex: none; width: 100%; min-width: 0; height: 45%; border-top: 1px solid #eee; }
            .map-hint { bottom: 10px; font-size: 12px; width: 80%; text-align: center; }
        }

        .map-title-overlay { position: absolute; top: 30px; left: 30px; z-index: 1000; text-align: center; pointer-events: none; }
        .title-bubble { background: #333; color: white; padding: 8px 25px; border-radius: 20px; font-weight: bold; font-size: 14px; display: inline-block; margin-bottom: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .map-label { background: #fff; border: 2px solid #333; padding: 5px 35px; border-radius: 20px; font-weight: bold; font-size: 16px; display: inline-block; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .list-view { padding: 30px; height: 100%; overflow-y: auto; box-sizing: border-box; }
        .company-list { list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; }
        .company-item { width: 50%; margin-bottom: 15px; cursor: pointer; font-size: 14px; display: flex; align-items: center; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px; }
        .company-id-num { display: inline-block; width: 25px; color: #888; font-size: 12px; font-weight: bold; }

        .detail-view { position: absolute; top: 0; left: 0; width: 100%; height: 100%; color: white; padding: 50px 35px; box-sizing: border-box; display: none; z-index: 10; overflow-y: auto; }
        .close-btn { position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 35px; cursor: pointer; }
        .detail-header { display: flex; align-items: center; margin-bottom: 2px; } 
        .detail-id-box { font-size: 20px; border: 2px solid white; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; border-radius: 50%; margin-right: 15px; font-weight: bold; flex-shrink: 0; }
        .detail-name { font-size: 26px; font-weight: bold; }
        .detail-subtitle { font-size: 14px; opacity: 0.9; margin-bottom: 20px; padding-left: 60px; } 
        .info-item { display: flex; align-items: flex-start; margin-bottom: 5px; font-size: 14px; } 
        .section-title { font-weight: bold; font-size: 15px; margin-top: 25px; margin-bottom: 8px; border-left: 3px solid white; padding-left: 10px; }
        .section-content { font-size: 13px; line-height: 1.6; opacity: 0.95; }
        .custom-marker { width: 36px; height: 36px; border: 2px solid white; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .marker-active .custom-marker { transform: scale(1.3); border-color: #333; }
    </style>
</head>
<body onmousedown="resetIdleTimer()" onmousemove="resetIdleTimer()" ontouchstart="resetIdleTimer()" onscroll="resetIdleTimer()" onkeydown="resetIdleTimer()">

<div class="map-title-overlay">
    <div class="title-bubble">2022-2026</div><br>
    <div class="map-label">MAP</div>
</div>

<div id="map-hint" class="map-hint">ğŸ“ ì§€ë„ì˜ <b>ì•„ì´ì½˜</b>ì„ í„°ì¹˜í•´ ë³´ì„¸ìš”!</div>

<div id="map"></div>
<div id="sidebar">
    <div class="list-view" id="listView">
        <div class="guide-banner">
            âœ¨ <b>ì‚¬ìš© ì•ˆë‚´</b><br>
            ì§€ë„ì˜ <b>ì•„ì´ì½˜</b>ì´ë‚˜ <b>ê¸°ì—… ë¦¬ìŠ¤íŠ¸</b>ë¥¼ ëˆ„ë¥´ë©´<br>
            ìƒì„¸í•œ í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
        <h2 style="margin: 0 0 20px 0; font-size: 18px; border-bottom: 2px solid #333; padding-bottom: 10px;">ì°¸ì—¬ ê¸°ì—… ë¦¬ìŠ¤íŠ¸</h2>
        <ul class="company-list" id="main-company-list"></ul>
    </div>
    
    <div class="detail-view" id="detailView">
        <button class="close-btn" onclick="showListView()">&times;</button>
        <div class="detail-header">
            <div class="detail-id-box" id="detailId">0</div>
            <div class="detail-name" id="detailName"></div>
        </div>
        <div class="detail-subtitle" id="detailSubTitle"></div>
        <div class="info-item">ğŸ“ <span id="detailAddress" style="margin-left:10px"></span></div>
        <div class="info-item">ğŸ“ <span id="detailPhone" style="margin-left:10px"></span></div>
        <div class="section-title">ê¸°ë³¸ ì„¤ëª…</div><div class="section-content" id="detailDesc"></div>
        <div class="section-title">ë¨¸ì‹ ì•„íŠ¸ë© ê´€ë ¨ì„±</div><div class="section-content" id="detailLabRelation"></div>
        <div class="section-title">ì„¸ë¶€ ì°¸ì—¬ ë‚´ìš©</div><div class="section-content" id="detailParticipation"></div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // ì—…ì²´ ë°ì´í„° ë° ì„¤ì •
    const categorySettings = { 'ìœ ì••Â·ìœ ê³µì••': { color: '#51E155', icon: `<svg viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg>` }, 'ì²  ê³µê¸‰Â·ì •ë°€ê°€ê³µ': { color: '#FDAE3B', icon: `<svg viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M5 4H19V7C16 7 14 9.5 14 12C14 14.5 16 17 19 17V20H5V17C8 17 10 14.5 10 12C10 9.5 8 7 5 7V4Z" /></svg>` }, 'ê³µêµ¬Â·MRO': { color: '#FE297B', icon: `<svg viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M22.7,19L13.6,9.9C14.5,7.6 14,4.9 12.1,3C10.1,1 7.1,0.6 4.7,1.7L9,6L6,9L1.7,4.7C0.6,7.1 1,10.1 3,12.1C4.9,14 7.6,14.5 9.9,13.6L19,22.7L22.7,19Z" /></svg>` }, 'ë„ë£ŒÂ·ë¯¸ìˆ ìì¬': { color: '#4FB7FE', icon: `<svg viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22C13.1,22 14,21.1 14,20C14,19.5 13.8,19.1 13.5,18.7C13.2,18.4 13,18 13,17.5A1.5,1.5 0 0,1 14.5,16H16A5,5 0 0,0 21,11C21,6 17,2 12,2M6.5,10C5.7,10 5,9.3 5,8.5C5,7.7 5.7,7 6.5,7C7.3,7 8,7.7 8,8.5C8,9.3 7.3,10 6.5,10M9.5,6C8.7,6 8,5.3 8,4.5C8,3.7 8.7,3 9.5,3C10.3,3 11,3.7 11,4.5C11,5.3 10.3,6 9.5,6M14.5,6C13.7,6 13,5.3 13,4.5C13,3.7 13.7,3 14.5,3C15.3,3 16,3.7 16,4.5C16,5.3 15.3,6 14.5,6M17.5,10C16.7,10 16,9.3 16,8.5C16,7.7 16.7,7 17.5,7C18.3,7 19,7.7 19,8.5C19,9.3 18.3,10 17.5,10Z" /></svg>` } };
    const companies = [
        { category: 'ìœ ì••Â·ìœ ê³µì••', name: 'ì„œì›ìœ ê³µì••ì‹œìŠ¤í…œ', lat: 35.9100, lng: 128.5900, addr: 'ëŒ€êµ¬ ë¶êµ¬ ìœ í†µë‹¨ì§€ë¡œ 16', tel: '053-604-0809', subTitle: 'ìœ ì•• ì‹¤ë¦°ë” ë° ë°¸ë¸Œ ì œì‘', desc: 'ë‹¤ì–‘í•œ ì‚°ì—… í˜„ì¥ì— ë§ì¶¤í˜• ìœ ì•• ì‹¤ë¦°ë”ì™€ ì œì–´ ë°¸ë¸Œë¥¼ ì œì‘í•˜ì—¬ ê³µê¸‰í•©ë‹ˆë‹¤.', labRelation: 'íŠ¹ìˆ˜ ê·œê²©ì˜ ìœ ì•• ë¶€í’ˆ ì œì‘ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  í˜‘ë ¥í•©ë‹ˆë‹¤.', participation: 'ë¨¸ì‹ ì•„íŠ¸ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ ë¹„ê·œê²© ì†Œí˜• ìœ ì•• ìœ ë‹›ì˜ ì‹œì œí’ˆì„ ì œì‘í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ìœ ì••Â·ìœ ê³µì••', name: '(ì£¼)í˜„ëŒ€ FA', lat: 36.0020, lng: 129.3420, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ì—°ì¼ì í˜•ì‚°ê°•ë‚¨ë¡œ 418ë²ˆê¸¸ 65', tel: '054-285-6318', subTitle: 'ê³µì¥ ìë™í™” ìœ ì•• ì†”ë£¨ì…˜', desc: 'ìë™í™” ê³µì •ì˜ ìœ ì•• ë° ê³µì•• ì‹œìŠ¤í…œì„ ì„¤ê³„í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê¸°ìˆ  ì¤‘ì‹¬ ê¸°ì—…ì…ë‹ˆë‹¤.', labRelation: 'ëŒ€í˜• ì¡°í˜•ë¬¼ì˜ ì•ˆì •ì ì¸ êµ¬ë™ì„ ìœ„í•œ ì‹œìŠ¤í…œ í†µí•© ìë¬¸ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.', participation: 'ë©”ì¸ êµ¬ë™ë¶€ì˜ ìœ ì•• ë¼ì¸ ë°°ì¹˜ ë° ëˆ„ìœ  ë°©ì§€ë¥¼ ìœ„í•œ í•˜ìš°ì§• ì„¤ê³„ì— ì°¸ì—¬í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ìœ ì••Â·ìœ ê³µì••', name: 'ì²œì§€ì¢…í•©ìƒì‚¬', lat: 36.0190, lng: 129.3490, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ëŒ€í•´ë¡œ 121', tel: '054-277-1233', subTitle: 'ê³ ì•• í˜¸ìŠ¤ ë° ìœ ì•• í”¼íŒ… ì „ë¬¸', desc: 'ë‹¤ì–‘í•œ ì••ë ¥ì„ ê²¬ë””ëŠ” ìœ ì•• í˜¸ìŠ¤ì™€ ì—°ê²° ë¶€ì†í’ˆì„ ì „ë¬¸ì ìœ¼ë¡œ ì·¨ê¸‰í•©ë‹ˆë‹¤.', labRelation: 'ë³µí•©ì ì¸ ê²½ë¡œ ì—°ê²°ì„ ìœ„í•œ ìì¬ ê³µê¸‰ ë° ì—°ê²° ìë¬¸ì„ ì œê³µí•©ë‹ˆë‹¤.', participation: 'ì•¼ì™¸ ì„¤ì¹˜ë¥¼ ê³ ë ¤í•œ ê³ ì„±ëŠ¥ ë‚´í›„ì„± ê³ ì•• í˜¸ìŠ¤ ì¼ì²´ë¥¼ ê³µê¸‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ìœ ì••Â·ìœ ê³µì••', name: 'ëŒ€ì§„ìœ ì••ì •ë°€', lat: 35.901636, lng: 128.583501, addr: 'ëŒ€êµ¬ ë¶êµ¬ ì¹¨ì‚°ë¡œ67ê¸¸ 50', tel: '053-253-1078', subTitle: 'ì •ë°€ ìœ ì•• ê°€ê³µ ë° ìœ ì§€ë³´ìˆ˜', desc: 'ì •ë°€í•œ ê°€ê³µ ê¸°ìˆ ì„ ë°”íƒ•ìœ¼ë¡œ ì‚°ì—…ìš© ê¸°ê¸° ìˆ˜ë¦¬ ë° ì œì‘ì„ ì „ë¬¸ìœ¼ë¡œ í•©ë‹ˆë‹¤.', labRelation: 'ì •ë°€í•œ ìˆ˜ì¹˜ê°€ í•„ìš”í•œ êµ¬ë™ë¶€ ê¸ˆì† ê°€ê³µì„ í˜‘ë ¥í•©ë‹ˆë‹¤.', participation: 'ìœ ì•• ì‹¤ë¦°ë”ë¥¼ ì‘í’ˆ ë³¸ì²´ì— ê³ ì •í•˜ê¸° ìœ„í•œ íŠ¹ìˆ˜ ë§ˆìš´íŠ¸ ë¸Œë¼ì¼“ ê°€ê³µì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ì²  ê³µê¸‰Â·ì •ë°€ê°€ê³µ', name: 'ê°•ë³€ì² ì¬', lat: 36.0025, lng: 129.3415, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ì—°ì¼ì í˜•ì‚°ê°•ë‚¨ë¡œ 418ë²ˆê¸¸ 54-1', tel: '054-286-2100', subTitle: 'ì¡°í˜•ë¬¼ìš© ì² ì œ ë° ë¹„ì² ê¸ˆì†', desc: 'ëŒ€í˜• ì² ê°•ì¬ ë° ì •ë°€ ê°€ê³µìš© ì² ì œ ì¬ë£Œë¥¼ ì „ë¬¸ì ìœ¼ë¡œ ìœ í†µí•©ë‹ˆë‹¤.', labRelation: 'ì‘í’ˆì˜ ë¼ˆëŒ€ê°€ ë˜ëŠ” ì£¼ìš” ê¸ˆì† ì¬ë£Œì˜ ìˆ˜ê¸‰ì²˜ì…ë‹ˆë‹¤.', participation: 'ì‘í’ˆ í”„ë ˆì„ ì œì‘ì— í•„ìš”í•œ Hë¹” ë° í›„íŒì˜ ì •ë°€ ì ˆë‹¨ ë° ë°°ì†¡ì„ ë‹´ë‹¹í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ì²  ê³µê¸‰Â·ì •ë°€ê°€ê³µ', name: 'ì„¸ì°½ê¸°ì—…', lat: 36.0028, lng: 129.3410, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ì—°ì¼ì í˜•ì‚°ê°•ë‚¨ë¡œ 418ë²ˆê¸¸ 43', tel: '054-285-8772', subTitle: 'ë ˆì´ì € ì»·íŒ… ë° ê¸ˆì† ê°€ê³µ', desc: 'ìµœì²¨ë‹¨ ë ˆì´ì € ì¥ë¹„ë¥¼ í™œìš©í•˜ì—¬ ì² íŒì„ ì •ë°€í•˜ê²Œ ê°€ê³µí•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.', labRelation: 'ë³µì¡í•œ ë„ë©´ì„ ì‹¤ì œ ê¸ˆì† íŒì¬ë¡œ êµ¬í˜„í•˜ëŠ” ê³µì • íŒŒíŠ¸ë„ˆì…ë‹ˆë‹¤.', participation: 'ì™¸ì¥ íŒ¨ë„ì˜ ë³µì¡í•œ ë¬¸ì–‘ì„ ë ˆì´ì € ì»·íŒ…ìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ ë¯¸í•™ì  ì™„ì„±ë„ë¥¼ ë†’ì˜€ìŠµë‹ˆë‹¤.' },
        { category: 'ì²  ê³µê¸‰Â·ì •ë°€ê°€ê³µ', name: 'ì‚¼ë³´ì •ë°€', lat: 36.0410, lng: 129.3710, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ì¹ ì„±ì²œê¸¸ 82', tel: '054-241-5075', subTitle: 'ì² ì œ ì •ë°€ ê°€ê³µ ë° êµ¬ì¡° ì„¤ê³„', desc: 'ì² ì œ ìš©ì ‘ ë° ì •ë°€ ê°€ê³µ ê¸°ìˆ ì„ ë°”íƒ•ìœ¼ë¡œ ì‚°ì—…ìš© ê¸°ê¸° ìˆ˜ë¦¬ ë° ì œì‘ì„ ì „ë¬¸ìœ¼ë¡œ í•©ë‹ˆë‹¤.', labRelation: 'ì£¼ì¬ë£Œì¸ ì² íŒŒì´í”„ ê³µê¸‰ê³¼ ë”ë¶ˆì–´, ì¡°í˜•ë¬¼ì˜ êµ¬ì¡°ì  ì•ˆì •ì„±ì„ ìœ„í•œ ê¸°ìˆ  ìë¬¸ ë° ë¶€í’ˆ ì„¤ê³„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.', participation: 'ì´ì•„í”¼ì˜ ì—´ ì œì–´ë¥¼ ìœ„í•œ ì¿¨ë§ íŒŒì´í”„ ë„ì… ì œì•ˆ ë° í¬í•­ I ì¡°í˜•ë¬¼ ì§€ì§€ëŒ€ì˜ ì •ë°€ ë² ì–´ë§ ì œì‘ì„ ë‹´ë‹¹í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ì²  ê³µê¸‰Â·ì •ë°€ê°€ê³µ', name: 'ê¸ˆì˜¤ì² ê°•', lat: 36.0050, lng: 129.3810, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ì—°ì¼ì ì² ê°•ë¡œ 107ë²ˆê¸¸ 8', tel: '054-286-2259', subTitle: 'ì² ê°• ìœ í†µ ë° ê°€ê³µ', desc: 'í¬í•­ ì² ê°•ë‹¨ì§€ì— ìœ„ì¹˜í•˜ì—¬ ê³ í’ˆì§ˆì˜ ì² ê°• ì¬ë£Œë¥¼ ìœ í†µí•˜ê³  1ì°¨ ê°€ê³µí•©ë‹ˆë‹¤.', labRelation: 'ëŒ€ëŸ‰ì˜ ê¸ˆì† ì¬ë£Œë¥¼ í•©ë¦¬ì ì¸ ë¹„ìš©ìœ¼ë¡œ ê³µê¸‰ë°›ëŠ” í˜‘ë ¥ ê´€ê³„ì…ë‹ˆë‹¤.', participation: 'ëŒ€í˜• ì‹¤ì™¸ ì„¤ì¹˜ë¬¼ì˜ í•˜ë‹¨ ì§€ì§€ êµ¬ì¡°ë¬¼ìš© ê°•ì¬ ì¼ì²´ë¥¼ ê³µê¸‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ê³µêµ¬Â·MRO', name: 'í¬í•­ì¢…í•©ìƒì‚¬', lat: 36.0385, lng: 129.3655, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ì¤‘ì•™ë¡œ 40-1', tel: '054-283-3598', subTitle: 'ì‚°ì—… ë° ë¶€í’ˆ ì´íŒ', desc: 'ì‚°ì—… í˜„ì¥ì— í•„ìš”í•œ ê¸°ê³„ê³µêµ¬, ì•ˆì „ìš©í’ˆ, ì†Œëª¨í’ˆ ì™¸ ëª¨ë“  ì œí’ˆì„ ì·¨ê¸‰í•©ë‹ˆë‹¤.', labRelation: 'ì‘í’ˆ ì¡°ë¦½ê³¼ í˜„ì¥ ì„¤ì¹˜ë¥¼ ìœ„í•œ ë¬¼í’ˆ ê³µê¸‰ ë° ì˜ˆìˆ ê°€ë“¤ì´ í•„ìš”ë¡œ í•˜ëŠ” ì œí’ˆì„ ì°¾ì•„ êµ¬í•´ì£¼ëŠ” êµ¬ë§¤ì²˜ì…ë‹ˆë‹¤.', participation: 'ì¼ë°˜ ì‚°ì—…í˜„ì¥ì—ì„œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” íŠ¹ìˆ˜í•œ ë¶€í’ˆë“¤ì„ ì¸í„°ë„· í•´ì™¸ì§êµ¬, í˜¹ì€ íƒ€ ì—…ì²´ì—ì„œ êµ¬ì…í•´ì„œ ê³µê¸‰ í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ê³µêµ¬Â·MRO', name: '(ì£¼)ë™ì„±ê³µêµ¬ë°±í™”ì ', lat: 36.0060, lng: 129.3820, addr: 'ê²½ë¶ í¬í•­ì‹œ ë‚¨êµ¬ ì² ê°•ë¡œ 182', tel: '054-285-9536', subTitle: 'ëŒ€í˜• ê³µêµ¬ ë° ê¸°êµ¬ ì „ë¬¸ë§¤ì¥', desc: 'ë°©ëŒ€í•œ ê·œëª¨ì˜ ë§¤ì¥ì— ë‹¤ì–‘í•œ ë¸Œëœë“œì˜ ì‚°ì—…ìš© ê¸°ê³„ ê³µêµ¬ë¥¼ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤.', labRelation: 'ìµœì‹  ê³µêµ¬ ê¸°ìˆ ê³¼ ì¥ë¹„ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ëŠ” ê¸°ìˆ  ì •ë³´ì²˜ì…ë‹ˆë‹¤.', participation: 'ê¸ˆì† í‘œë©´ ë§ˆê° ì‘ì—…(ê·¸ë¼ì¸ë”©)ì„ ìœ„í•œ ëŒ€í˜• ì‚°ì—…ìš© ì—°ë§ˆ ì¥ë¹„ë¥¼ ê³µê¸‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ê³µêµ¬Â·MRO', name: 'ëŒ€ì„±ê³µêµ¬ì‚¬', lat: 36.0420, lng: 129.3705, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ì¹ ì„±ë¡œ 7', tel: '054-247-6896', subTitle: 'ìš©ì ‘ ë° ë°°ê´€ ì¥ë¹„ ì „ë¬¸', desc: 'ìš©ì ‘ê¸°, ìš©ì ‘ë´‰ ë° ë°°ê´€ ì‘ì—…ìš© íŠ¹ìˆ˜ ê³µêµ¬ë¥¼ ì „ë¬¸ì ìœ¼ë¡œ íŒë§¤í•©ë‹ˆë‹¤.', labRelation: 'ê¸ˆì† í”„ë ˆì„ ìš©ì ‘ ê¸°ìˆ  ë° ì¬ë£Œ ìë¬¸ì„ ì œê³µí•©ë‹ˆë‹¤.', participation: 'íŠ¹ìˆ˜ í•©ê¸ˆ ìš©ì ‘ì— í•„ìš”í•œ ê³ ì„±ëŠ¥ ìš©ì ‘ê¸° ë° ì•ˆì „ ì¥ë¹„ë¥¼ ëŒ€ì—¬ ë° ì§€ì›í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ê³µêµ¬Â·MRO', name: '(ì£¼)ì„¸ì›ìƒì‚¬', lat: 36.0425, lng: 129.3715, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ì¹ ì„±ë¡œ 19', tel: '054-241-2785', subTitle: 'ì‚°ì—… ê¸°ìì¬ ë° ì†Œëª¨í’ˆ ë‚©í’ˆ', desc: 'ì² ê°• ê³µë‹¨ì— í•„ìš”í•œ ë‹¤ì–‘í•œ ì‚°ì—… ê¸°ìì¬ì™€ ì•ˆì „ìš©í’ˆì„ ë‚©í’ˆí•©ë‹ˆë‹¤.', labRelation: 'í˜„ì¥ ì‘ì—…ìì˜ ì•ˆì „ ë° ì†Œëª¨ì„± ë¶€í’ˆ ìˆ˜ê¸‰ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.', participation: 'ì‘ì—… í˜„ì¥ ì•ˆì „íœìŠ¤ ë° ì‘í’ˆ ë‚´ë¶€ì— ë“¤ì–´ê°€ëŠ” ê°ì¢… ë‚˜ì‚¬ ë° ë² ì–´ë§ ì†Œëª¨í’ˆì„ ê³µê¸‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ë„ë£ŒÂ·ë¯¸ìˆ ìì¬', name: 'í¬í•­ë¬¸êµ¬ì„¼í„°', lat: 36.0415, lng: 129.3585, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ìƒˆì²œë…„ëŒ€ë¡œ 1001ë²ˆê¸¸ 3', tel: '0507-1388-8856', subTitle: 'ë¬¼ê°, ì„ê³ , í˜ì¸íŠ¸, ê¸°íƒ€ ë¯¸ìˆ ë„ë£Œ', desc: 'ì§€ì—­ ë‚´ ìµœëŒ€ ê·œëª¨ì˜ ë¬¸êµ¬ ë° ë¯¸ìˆ  ì „ë¬¸ ì¬ë£Œë¥¼ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.', labRelation: 'í‘œë©´ ì§ˆê° í‘œí˜„ ë° ëª¨í˜• ì œì‘ì— í•„ìš”í•œ ê¸°ë³¸ ì¬ë£Œ ìˆ˜ê¸‰ì²˜ì…ë‹ˆë‹¤.', participation: 'ì‹¤í—˜ ì‹œì œí’ˆì˜ í‘œë©´ ì§ˆê°ì„ ë‚´ê¸° ìœ„í•œ íŠ¹ìˆ˜ ì„ê³ ì™€ ë„ë£Œ ì¬ë£Œë¥¼ ê³µê¸‰í–ˆìŠµë‹ˆë‹¤.' },
        { category: 'ë„ë£ŒÂ·ë¯¸ìˆ ìì¬', name: 'ì‚¼í™”í˜ì¸íŠ¸', lat: 36.0450, lng: 129.3720, addr: 'ê²½ë¶ í¬í•­ì‹œ ë¶êµ¬ ëŒ€ì‹ ë¡œ 3', tel: '054-232-0027', subTitle: 'ì „ë¬¸ê°€ìš© ë„ë£Œ ë° ì¡°ìƒ‰ ì„œë¹„ìŠ¤', desc: 'ì‚°ì—…ìš©ë¶€í„° ì˜ˆìˆ ìš©ê¹Œì§€ ì •ë°€í•œ ì¡°ìƒ‰ì´ ê°€ëŠ¥í•œ í˜ì¸íŠ¸ ì „ë¬¸ì ì…ë‹ˆë‹¤.', labRelation: 'ì‘í’ˆì˜ ìµœì¢… ì‹œê°ì  íš¨ê³¼ì¸ ìƒ‰ì±„ ì—°ì¶œ ë° ì½”íŒ… ìë¬¸ì„ ì œê³µí•©ë‹ˆë‹¤.', participation: 'ê±°ëŒ€ ì¡°í˜•ë¬¼ì˜ ì•¼ì™¸ ë³€ìƒ‰ ë°©ì§€ë¥¼ ìœ„í•œ UV ì°¨ë‹¨ ê¸°ëŠ¥ì„± í˜ì¸íŠ¸ ì¡°ìƒ‰ì„ ì§€ì›í–ˆìŠµë‹ˆë‹¤.' }
    ];

    const map = L.map('map', { zoomControl: false });
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { maxZoom: 20 }).addTo(map);

    let currentPolyline = null;
    let selectedMarker = null;
    let currentUpdateFn = null; 
    let idleTimer; // íƒ€ì´ë¨¸ ë³€ìˆ˜

    // íƒ€ì´ë¨¸ ì´ˆê¸°í™” í•¨ìˆ˜ (60ì´ˆ ì„¤ì •)
    function resetIdleTimer() {
        clearTimeout(idleTimer);
        // 60,000ms = 60ì´ˆê°„ ì…ë ¥ ì—†ìœ¼ë©´ showListView ì‹¤í–‰
        idleTimer = setTimeout(() => {
            console.log("ìë™ ë³µê·€ ì‹¤í–‰");
            showListView();
        }, 60000); 
    }

    function init() {
        const listUl = document.getElementById('main-company-list');
        const bounds = L.latLngBounds(); 
        companies.forEach((company, index) => {
            const globalId = index + 1;
            const setting = categorySettings[company.category]; 
            const customIcon = L.divIcon({
                className: '',
                html: `<div class="custom-marker" style="background:${setting.color};">${setting.icon}</div>`,
                iconSize: [36, 36], iconAnchor: [18, 18]
            });
            const marker = L.marker([company.lat, company.lng], { icon: customIcon }).addTo(map);
            marker.on('click', () => { handleSelect(marker, company, globalId); resetIdleTimer(); });
            bounds.extend([company.lat, company.lng]);
            const li = document.createElement('li');
            li.className = 'company-item';
            li.innerHTML = `<span class="company-id-num">${globalId}</span> ${company.name}`;
            li.onclick = () => { handleSelect(marker, company, globalId); resetIdleTimer(); };
            listUl.appendChild(li);
        });
        map.fitBounds(bounds, { padding: [50, 50] });
        resetIdleTimer(); // ì´ˆê¸° ì‹¤í–‰
    }

    function handleSelect(marker, company, displayId) {
        // ì—…ì²´ ì„ íƒ ì‹œ ì•ˆë‚´ ë§í’ì„  ìˆ¨ê¸°ê¸°
        document.getElementById('map-hint').style.display = 'none';

        if (selectedMarker) {
            L.DomUtil.removeClass(selectedMarker.getElement(), 'marker-active');
            selectedMarker.setZIndexOffset(0);
        }
        L.DomUtil.addClass(marker.getElement(), 'marker-active');
        marker.setZIndexOffset(1000);
        selectedMarker = marker;

        const detailView = document.getElementById('detailView');
        document.getElementById('listView').style.display = 'none';
        detailView.style.display = 'block';

        const setting = categorySettings[company.category];
        detailView.style.backgroundColor = setting.color;
        document.getElementById('detailId').innerText = displayId;
        document.getElementById('detailName').innerText = company.name;
        document.getElementById('detailSubTitle').innerText = company.subTitle;
        document.getElementById('detailAddress').innerText = company.addr;
        document.getElementById('detailPhone').innerText = company.tel;
        document.getElementById('detailDesc').innerText = company.desc;
        document.getElementById('detailLabRelation').innerText = company.labRelation;
        document.getElementById('detailParticipation').innerText = company.participation;

        map.invalidateSize(); 
        map.setView([company.lat, company.lng], 14); 
        drawLinkLine(marker, company);
    }

    function drawLinkLine(marker, company) {
        if (currentPolyline) map.removeLayer(currentPolyline);
        if (currentUpdateFn) map.off('move', currentUpdateFn);
        const updateLine = () => {
            const markerLatLng = marker.getLatLng();
            let panelPoint = (window.innerWidth <= 768) ? map.containerPointToLatLng(L.point(map.getSize().x / 2, map.getSize().y)) : map.containerPointToLatLng(L.point(map.getSize().x, map.getSize().y / 2));
            currentPolyline.setLatLngs([markerLatLng, panelPoint]);
        };
        currentPolyline = L.polyline([marker.getLatLng(), marker.getLatLng()], { color: categorySettings[company.category].color, weight: 5, opacity: 0.9 }).addTo(map);
        currentUpdateFn = updateLine; updateLine();
        map.on('move', currentUpdateFn);
    }

    function showListView() {
        document.getElementById('map-hint').style.display = 'block';
        if (currentPolyline) { map.removeLayer(currentPolyline); currentPolyline = null; }
        if (currentUpdateFn) { map.off('move', currentUpdateFn); currentUpdateFn = null; }
        if (selectedMarker) { L.DomUtil.removeClass(selectedMarker.getElement(), 'marker-active'); selectedMarker.setZIndexOffset(0); selectedMarker = null; }
        document.getElementById('detailView').style.display = 'none';
        document.getElementById('listView').style.display = 'block';
        map.invalidateSize();
        const bounds = L.latLngBounds(companies.map(c => [c.lat, c.lng]));
        map.fitBounds(bounds, { padding: [50, 50] });
    }

    init();
    // ì§€ë„ ì›€ì§ì„ë„ ì¡°ì‘ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ íƒ€ì´ë¨¸ ë¦¬ì…‹
    map.on('movestart', resetIdleTimer);
</script>
</body>
</html>
